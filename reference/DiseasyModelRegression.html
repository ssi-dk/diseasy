<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Base module for the regression class of models — DiseasyModelRegression • diseasy</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Base module for the regression class of models — DiseasyModelRegression"><meta name="description" content="The DiseasyModelRegression module implements common structure and functionality to regression class of models
beyond the model structure provided by ?DiseasyModel.
Most notably, the model module implements the $get_results() method.
This implementation requires the subclass to implement the $fit_regression(), $get_prediction() and
$update_formula() methods.
The $fit_regression() method should fit the regression model to the training data.
In the case of a GLM model, this would be a call to stats::glm.
The $get_prediction() method should predict the future values of the observable.
In the case of a GLM model, this would be a call to stats::predict.
The $update_formula() method should update the formula based on the stratifications.
If the model should flexibly adapt to different stratifications, this method should be implemented.
See ?DiseasyModelGLM and ?DiseasyModelBRM for examples of how this can be done."><meta property="og:description" content="The DiseasyModelRegression module implements common structure and functionality to regression class of models
beyond the model structure provided by ?DiseasyModel.
Most notably, the model module implements the $get_results() method.
This implementation requires the subclass to implement the $fit_regression(), $get_prediction() and
$update_formula() methods.
The $fit_regression() method should fit the regression model to the training data.
In the case of a GLM model, this would be a call to stats::glm.
The $get_prediction() method should predict the future values of the observable.
In the case of a GLM model, this would be a call to stats::predict.
The $update_formula() method should update the formula based on the stratifications.
If the model should flexibly adapt to different stratifications, this method should be implemented.
See ?DiseasyModelGLM and ?DiseasyModelBRM for examples of how this can be done."><meta property="og:image" content="https://ssi-dk.github.io/diseasy/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">diseasy</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/diseasy.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Creating ensembles</h6></li>
    <li><a class="dropdown-item" href="../articles/creating-ensembles.html">Creating ensembles</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Functional modules</h6></li>
    <li><a class="dropdown-item" href="../articles/diseasy-activity.html">DiseasyActivity</a></li>
    <li><a class="dropdown-item" href="../articles/diseasy-immunity.html">DiseasyImmunity</a></li>
    <li><a class="dropdown-item" href="../articles/diseasy-observables.html">DiseasyObservables</a></li>
    <li><a class="dropdown-item" href="../articles/diseasy-season.html">DiseasySeason</a></li>
    <li><a class="dropdown-item" href="../articles/diseasy-variant.html">DiseasyVariant</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Model templates</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer guides</h6></li>
    <li><a class="dropdown-item" href="../articles/creating-a-model.html">Creating a model</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Model notes</h6></li>
    <li><a class="dropdown-item" href="../articles/SEIR-implementation.html">SEIR: Implementation</a></li>
    <li><a class="dropdown-item" href="../articles/SEIR-initialisation.html">SEIR: Initialising from incidence data</a></li>
    <li><a class="dropdown-item" href="../articles/SEIR-malthusian-matching.html">SEIR: Accounting for structural differences in malthusian growth rates</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Additional information</h6></li>
    <li><a class="dropdown-item" href="../articles/creating-a-model.html">Creating a model</a></li>
    <li><a class="dropdown-item" href="../articles/creating-ensembles.html">Creating ensembles</a></li>
    <li><a class="dropdown-item" href="../articles/diseasy-activity.html">DiseasyActivity</a></li>
    <li><a class="dropdown-item" href="../articles/diseasy-immunity-optimisation.html">DiseasyImmunity optimisation</a></li>
    <li><a class="dropdown-item" href="../articles/diseasy-immunity.html">DiseasyImmunity</a></li>
    <li><a class="dropdown-item" href="../articles/diseasy-model-ode.html">DiseasyModelOde</a></li>
    <li><a class="dropdown-item" href="../articles/diseasy-model-regression.html">DiseasyModelRegression</a></li>
    <li><a class="dropdown-item" href="../articles/diseasy-observables.html">DiseasyObservables</a></li>
    <li><a class="dropdown-item" href="../articles/diseasy-season.html">DiseasySeason</a></li>
    <li><a class="dropdown-item" href="../articles/diseasy-variant.html">DiseasyVariant</a></li>
    <li><a class="dropdown-item" href="../articles/SEIR-implementation.html">SEIR: Implementation</a></li>
    <li><a class="dropdown-item" href="../articles/SEIR-initialisation.html">SEIR: Initialising from incidence data</a></li>
    <li><a class="dropdown-item" href="../articles/SEIR-malthusian-matching.html">SEIR: Accounting for structural differences in malthusian growth rates</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ssi-dk/diseasy/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Base module for the regression class of models</h1>
      <small class="dont-index">Source: <a href="https://github.com/ssi-dk/diseasy/blob/main/R/DiseasyModelRegression.R" class="external-link"><code>R/DiseasyModelRegression.R</code></a></small>
      <div class="d-none name"><code>DiseasyModelRegression.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>DiseasyModelRegression</code> module implements common structure and functionality to regression class of models
beyond the model structure provided by <code><a href="DiseasyModel.html">?DiseasyModel</a></code>.</p>
<p>Most notably, the model module implements the <code>$get_results()</code> method.
This implementation requires the subclass to implement the <code>$fit_regression()</code>, <code>$get_prediction()</code> and
<code>$update_formula()</code> methods.</p>
<p>The <code>$fit_regression()</code> method should fit the regression model to the training data.
In the case of a GLM model, this would be a call to <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">stats::glm</a></code>.</p>
<p>The <code>$get_prediction()</code> method should predict the future values of the observable.
In the case of a GLM model, this would be a call to <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">stats::predict</a></code>.</p>
<p>The <code>$update_formula()</code> method should update the formula based on the stratifications.
If the model should flexibly adapt to different stratifications, this method should be implemented.
See <code><a href="Diseasy-GLM-models.html">?DiseasyModelGLM</a></code> and <code><a href="Diseasy-BRM-models.html">?DiseasyModelBRM</a></code> for examples of how this can be done.</p>
    </div>


    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A new instance of the <code>DiseasyModelRegression</code> <a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6</a> class.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://rdrr.io/r/stats/family.html" class="external-link">stats::family</a>, <a href="https://rdrr.io/r/stats/formula.html" class="external-link">stats::as.formula</a>, <a href="Diseasy-GLM-models.html">DiseasyModelG0</a>, <a href="Diseasy-GLM-models.html">DiseasyModelG1</a>, <a href="Diseasy-BRM-models.html">DiseasyModelB0</a>, <a href="Diseasy-GLM-models.html">DiseasyModelG1</a></p>
<p><a href="DiseasyObservables.html">DiseasyObservables</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="super-classes">Super classes<a class="anchor" aria-label="anchor" href="#super-classes"></a></h2>
    <p><code><a href="DiseasyBaseModule.html">diseasy::DiseasyBaseModule</a></code> -&gt; <code><a href="DiseasyModel.html">diseasy::DiseasyModel</a></code> -&gt; <code>DiseasyModelRegression</code></p>
    </div>
    <div class="section level2">
    <h2 id="active-bindings">Active bindings<a class="anchor" aria-label="anchor" href="#active-bindings"></a></h2>
    <p></p><div class="r6-active-bindings"><dl><dt><code>formula</code></dt>
<dd><p>(<code>formula</code>)<br>
The base formula of the module. Stratification features extend this base formula. Read-only.</p></dd>


<dt><code>family</code></dt>
<dd><p>(<code>family</code>)<br>
The family used in the regression fit (see <code>glm</code> or <code>brms</code>). Read-only.</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-DiseasyModelRegression-new"><code>DiseasyModelRegression$new()</code></a></p></li>
<li><p><a href="#method-DiseasyModelRegression-get_results"><code>DiseasyModelRegression$get_results()</code></a></p></li>
<li><p><a href="#method-DiseasyModelRegression-plot"><code>DiseasyModelRegression$plot()</code></a></p></li>
<li><p><a href="#method-DiseasyModelRegression-clone"><code>DiseasyModelRegression$clone()</code></a></p></li>
</ul></div><p><details open><summary>Inherited methods</summary><ul><li><span class="pkg-link" data-pkg="diseasy" data-topic="DiseasyBaseModule" data-id="load_module"><a href="DiseasyBaseModule.html#method-load_module"><code>diseasy::DiseasyBaseModule$load_module()</code></a></span></li>
<li><span class="pkg-link" data-pkg="diseasy" data-topic="DiseasyBaseModule" data-id="set_moduleowner"><a href="DiseasyBaseModule.html#method-set_moduleowner"><code>diseasy::DiseasyBaseModule$set_moduleowner()</code></a></span></li>
<li><span class="pkg-link" data-pkg="diseasy" data-topic="DiseasyModel" data-id="get_data"><a href="DiseasyModel.html#method-get_data"><code>diseasy::DiseasyModel$get_data()</code></a></span></li>
</ul></details></p><hr><a id="method-DiseasyModelRegression-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Creates a new instance of the <code>DiseasyModelRegression</code> <a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6</a> class.
This module is typically not constructed directly but rather through <code>DiseasyModel*</code> classes,
such as <a href="Diseasy-GLM-models.html">DiseasyModelG0</a>.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/DiseasyModelRegression.html">DiseasyModelRegression</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">formula</span>, <span class="va">family</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>formula</code></dt>
<dd><p>(<code>character</code>)<br>
A <code>character</code> string that is passed to <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">stats::as.formula</a></code> via <code>glue</code> (see details).</p></dd>


<dt><code>family</code></dt>
<dd><p>(<code>family</code>)<br><code><a href="https://rdrr.io/r/stats/family.html" class="external-link">stats::family</a></code> object passed to the regression call.</p></dd>


<dt><code>...</code></dt>
<dd><p>parameters sent to <code>DiseasyModel</code> <a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6</a> constructor.</p></dd>


<dt><code>parameters</code></dt>
<dd><p>(<code>named list()</code>)<br></p><ul><li><p><code>training_length</code> (<code>named numeric(3)</code>)<br>   The number of days that should be included in the training splits of the data for the model.   Allowed splits are: "training", "testing", and "validation".</p></li>
</ul></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h4>
<p>The observable will change at run time and we therefore cannot define a static formula.
We can use "{observable}" in our formula which will then be translated at run time.
For example, if the requested observable is "n_hospital" and the formula is "{observable} ~ 1",
then at run time, the formula will translate to "n_hospital ~ 1".</p>
<p>Furthermore the stratification can also change at run time, so the model should incorporate a
<code>update_formula(stratification)</code> function that accounts for changes in stratification.</p>
</div>


</div><p></p><hr><a id="method-DiseasyModelRegression-get_results"></a><div class="section">
<h3 id="method-get-results-">Method <code>get_results()</code><a class="anchor" aria-label="anchor" href="#method-get-results-"></a></h3>
<p>The primary method used to request model results of a given observable at a given stratification</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">DiseasyModelRegression</span><span class="op">$</span><span class="fu">get_results</span><span class="op">(</span></span>
<span>  <span class="va">observable</span>,</span>
<span>  <span class="va">prediction_length</span>,</span>
<span>  quantiles <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stratification <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>observable</code></dt>
<dd><p>(<code>character</code>)<br> The observable to provide data or prediction for.</p></dd>


<dt><code>prediction_length</code></dt>
<dd><p>(<code>numeric</code>)<br> The number of days to predict. The prediction start is defined by <code>last_queryable_date</code> of the <code><a href="DiseasyObservables.html">?DiseasyObservables</a></code> <a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6</a> class.</p></dd>


<dt><code>quantiles</code></dt>
<dd><p>(<code>list</code>(<code>numeric</code>))<br> If given, results are returned at the quantiles given.</p></dd>


<dt><code>stratification</code></dt>
<dd><p>(<code>list</code>(<code>quosures</code>) or <code>NULL</code>)<br> Use <code>rlang::quos(...)</code> to specify stratification. If given, expressions in stratification evaluated to give the stratification level.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>A <code>tibble</code> <a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble::tibble</a> with predictions at the level specified by stratification level. In addition to stratification columns, the output has the columns:<br><br>  - date (<code>Date</code>) specifying the date of the prediction.<br>  - realisation_id (<code>character</code>) giving a unique id for each realization in the ensemble.<br>  - weight (<code>numeric</code>) giving the weight of the realization in the ensemble.</p>
</div>

</div><p></p><hr><a id="method-DiseasyModelRegression-plot"></a><div class="section">
<h3 id="method-plot-">Method <code><a href="plot.html">plot()</a></code><a class="anchor" aria-label="anchor" href="#method-plot-"></a></h3>
<p>Plot the predictions from the current model</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">DiseasyModelRegression</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span></span>
<span>  <span class="va">observable</span>,</span>
<span>  <span class="va">prediction_length</span>,</span>
<span>  stratification <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>observable</code></dt>
<dd><p>(<code>character</code>)<br> The observable to provide data or prediction for.</p></dd>


<dt><code>prediction_length</code></dt>
<dd><p>(<code>numeric</code>)<br> The number of days to predict. The prediction start is defined by <code>last_queryable_date</code> of the <code><a href="DiseasyObservables.html">?DiseasyObservables</a></code> <a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6</a> class.</p></dd>


<dt><code>stratification</code></dt>
<dd><p>(<code>list</code>(<code>quosures</code>) or <code>NULL</code>)<br> Use <code>rlang::quos(...)</code> to specify stratification. If given, expressions in stratification evaluated to give the stratification level.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-DiseasyModelRegression-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">DiseasyModelRegression</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># This module cannot be constructed directly but should instead be used to</span></span></span>
<span class="r-in"><span>  <span class="co"># inherit from when creating a new model class.</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rasmus Skytte Randløv, Marcus Munch Grünewald, Lasse Engbo Christiansen, Kaare Græsbøll, Sofia Myrup Otero, <a href="https://www.ssi.dk/" class="external-link"><img src="https://www.ssi.dk/assets/images/ssi-logo-optimeret.svg" alt="SSI" height="64" style="margin-bottom: 0.5em; margin-top: 1.5em;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

